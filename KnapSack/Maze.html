{% extends "global/Page.html" %}
{% load otree %}

{% block content %}

<html><head>



    <style>
       html {height: 100%}

       #center {
       width: 50%;
       margin: auto;

       }
       body, td {
       font-family: serif;
       background:#7abcff;/* Old browsers */
       /* background: -moz-linear-gradient(top, #7abcff 0%, #60abf8 44%, #4096ee 100%);  FF3.6-15 */
       /* background: -webkit-linear-gradient(top, #7abcff 0%,#60abf8 44%,#4096ee 100%);  Chrome10-25,Safari5.1-6 */
       /* background: linear-gradient(to bottom, #7abcff 0%,#60abf8 44%,#4096ee 100%);*/
       font-size: 13 px;
       }



       .myButton{
       width:0.001px;
       height:0.001px;
       background-color:#DBFEF8;
       -moz-border-radius:28px;
       -webkit-border-radius:28px;
       border-radius:28px;
       border:1px solid #18ab29;
       cursor:pointer;
       color:#000000;
       font-family:Arial;
       font-size:10px;
       padding:12px 10px;
       margin: -12px -12px;
       text-decoration:none;
       text-shadow:none;
       position:absolute;

       }

       .myButton:hover {
       background-color:#DBFEF8;
       }
       .myButton:active {
       background-color:#DBFEF8;
       }

       .myButtonTwo{
       width:0.001px;
       height:0.001px;
       background-color:gold;
       -moz-border-radius:28px;
       -webkit-border-radius:28px;
       border-radius:28px;
       border:1px solid #18ab29;
       cursor:pointer;
       color:#000000;
       font-family:Arial;
       font-size:10px;
       padding:12px 10px;
       margin: -12px -12px;
       text-decoration:none;
       text-shadow:none;
       position:absolute;

       }
       .colour{
       opacity:0.0;
       }
       /* .myButtonTwo:hover {
       background-color:#FFCF75;
       } */
       /*.myButtonTwo:active {
       background-color:#FFCF75;
       }*/


       .buttonPosition{
       position:absolute;
       }

       .box {
       margin-top:10px;
       margin-bottom:auto;
       border:10px solid white;
       max-width:900px;
       padding:20px;
       border-radius: 20px;
       -webkit-border-radius: 15px;
       -moz-border-radius: 15px;
       background:#66CDAA;
       color:white;
       font-weight:bold;
       margin:50px auto;
       /*height:550px;*/
       /*width: 600px;*/
       height:850px;
       width: 920px;
       }



       /* basic positioning */
.legend { list-style: none; }
.legend li { float: left; margin-right: 10px; }
.legend span { border: 1px solid #ccc; float: left; width: 12px; height: 12px; margin: 2px; }
/* your colors */
.legend .superawesome { background-color: orange; }
.legend .awesome { background-color: red; }
.legend .kindaawesome { background-color: blue; }
.legend .notawesome { background-color: purple; }
.legend .grey { background-color: grey; }
.legend .brown { background-color: brown; }
.legend .pink { background-color: pink; }
.legend .white { background-color: white; }
       </style>

</head>
<br>
<p align="center" style="font-family:lucida sans unicode,lucida grande,sans-serif;"><span style="color: white;font-size:25px">Level {level} out of {t_question}.</span></p>
<body>
<p align="center" style="font-family:lucida sans unicode,lucida grande,sans-serif;font-size:20px;"><font color="white"></font></p>
<p align="center" style="font-family:lucida sans unicode,lucida grande,sans-serif;font-size:20px;"><font color="white">To start, click on the first node at the bottom of the maze.</font></p>
<input id="countdown" name="timeLeft" type="hidden" />
<div style="text-align: center; font-size:35px"><font color="white ">Timer: <span id="countdown2">&nbsp;</span></font></div>
<div align=center><div class=box>
<div style= 'position:relative;width:auto; height:auto;margin:0 auto' id = 'graphContainer'>
<div onClick='nodeClick(this)' id = '1' class ="myButton" style = 'z-index:1; left:428.666625px;top:720.170698362876px'> <span class=colour>1</span></div>
<div onClick='nodeClick(this)' id = '2' class ="myButtonTwo" style = 'z-index:1; left:532.446879091301px;top:514.6857952621px'> <span class=colour>2</span></div>
<div onClick='nodeClick(this)' id = '3' class ="myButtonTwo" style = 'z-index:1; left:636.227133182601px;top:309.200892161325px'> <span class=colour>3</span></div>
<div onClick='nodeClick(this)' id = '4' class ="myButtonTwo" style = 'z-index:1; left:740.007387273902px;top:103.71598906055px'> <span class=colour>4</span></div>
<div onClick='nodeClick(this)' id = '5' class ="myButtonTwo" style = 'z-index:1; left:324.886370908699px;top:514.6857952621px'> <span class=colour>5</span></div>
<div onClick='nodeClick(this)' id = '6' class ="myButton" style = 'z-index:1; left:428.666625px;top:309.200892161325px'> <span class=colour>6</span></div>
<div onClick='nodeClick(this)' id = '7' class ="myButtonTwo" style = 'z-index:1; left:532.446879091301px;top:103.71598906055px'> <span class=colour>7</span></div>
<div onClick='nodeClick(this)' id = '9' class ="myButtonTwo" style = 'z-index:1; left:221.106116817399px;top:309.200892161325px'> <span class=colour>9</span></div>
<div onClick='nodeClick(this)' id = '10' class ="myButtonTwo" style = 'z-index:1; left:324.886370908699px;top:103.71598906055px'> <span class=colour>10</span></div>
<div onClick='nodeClick(this)' id = '13' class ="myButtonTwo" style = 'z-index:1; left:117.325862726098px;top:103.71598906055px'> <span class=colour>13</span></div>
<div>
 <svg height="1000" width="1000">
                            <defs>
                            <marker id="arrow" markerWidth="100" markerHeight="50" refx="15" refy="6" orient="auto">
                            <path id="colourArrow" d="M2,1 L2,10 L10,6 L2,2" style="fill:blue" />
                            </marker>
                            </defs>
                            <path id="1_2" d="M428.666625 720.170698362876 L532.446879091301 514.6857952621" style="stroke:orange; stroke-width: 3.25px; fill: none ;marker-end: url(#arrow1);" >
                            </path>
                            <defs>
                            <marker id="arrow" markerWidth="100" markerHeight="50" refx="15" refy="6" orient="auto">
                            <path id="colourArrow" d="M2,1 L2,10 L10,6 L2,2" style="fill:blue" />
                            </marker>
                            </defs>
                            <path id="1_5" d="M428.666625 720.170698362876 L324.886370908699 514.6857952621" style="stroke:red; stroke-width: 3.25px; fill: none ;marker-end: url(#arrow2);" >
                            </path>
                            <defs>
                            <marker id="arrow" markerWidth="100" markerHeight="50" refx="15" refy="6" orient="auto">
                            <path id="colourArrow" d="M2,1 L2,10 L10,6 L2,2" style="fill:blue" />
                            </marker>
                            </defs>
                            <path id="2_3" d="M532.446879091301 514.6857952621 L636.227133182601 309.200892161325" style="stroke:blue; stroke-width: 3.25px; fill: none ;marker-end: url(#arrow3);" >
                            </path>
                            <defs>
                            <marker id="arrow" markerWidth="100" markerHeight="50" refx="15" refy="6" orient="auto">
                            <path id="colourArrow" d="M2,1 L2,10 L10,6 L2,2" style="fill:blue" />
                            </marker>
                            </defs>
                            <path id="2_6" d="M532.446879091301 514.6857952621 L428.666625 309.200892161325" style="stroke:purple; stroke-width: 3.25px; fill: none ;marker-end: url(#arrow4);" >
                            </path>
                            <defs>
                            <marker id="arrow" markerWidth="100" markerHeight="50" refx="15" refy="6" orient="auto">
                            <path id="colourArrow" d="M2,1 L2,10 L10,6 L2,2" style="fill:blue" />
                            </marker>
                            </defs>
                            <path id="3_4" d="M636.227133182601 309.200892161325 L740.007387273902 103.71598906055" style="stroke:orange; stroke-width: 3.25px; fill: none ;marker-end: url(#arrow5);" >
                            </path>
                            <defs>
                            <marker id="arrow" markerWidth="100" markerHeight="50" refx="15" refy="6" orient="auto">
                            <path id="colourArrow" d="M2,1 L2,10 L10,6 L2,2" style="fill:blue" />
                            </marker>
                            </defs>
                            <path id="3_7" d="M636.227133182601 309.200892161325 L532.446879091301 103.71598906055" style="stroke:grey; stroke-width: 3.25px; fill: none ;marker-end: url(#arrow6);" >
                            </path>
                            <defs>
                            <marker id="arrow" markerWidth="100" markerHeight="50" refx="15" refy="6" orient="auto">
                            <path id="colourArrow" d="M2,1 L2,10 L10,6 L2,2" style="fill:blue" />
                            </marker>
                            </defs>
                            <path id="5_6" d="M324.886370908699 514.6857952621 L428.666625 309.200892161325" style="stroke:purple; stroke-width: 3.25px; fill: none ;marker-end: url(#arrow7);" >
                            </path>
                            <defs>
                            <marker id="arrow" markerWidth="100" markerHeight="50" refx="15" refy="6" orient="auto">
                            <path id="colourArrow" d="M2,1 L2,10 L10,6 L2,2" style="fill:blue" />
                            </marker>
                            </defs>
                            <path id="5_9" d="M324.886370908699 514.6857952621 L221.106116817399 309.200892161325" style="stroke:grey; stroke-width: 3.25px; fill: none ;marker-end: url(#arrow8);" >
                            </path>
                            <defs>
                            <marker id="arrow" markerWidth="100" markerHeight="50" refx="15" refy="6" orient="auto">
                            <path id="colourArrow" d="M2,1 L2,10 L10,6 L2,2" style="fill:blue" />
                            </marker>
                            </defs>
                            <path id="6_7" d="M428.666625 309.200892161325 L532.446879091301 103.71598906055" style="stroke:orange; stroke-width: 3.25px; fill: none ;marker-end: url(#arrow9);" >
                            </path>
                            <defs>
                            <marker id="arrow" markerWidth="100" markerHeight="50" refx="15" refy="6" orient="auto">
                            <path id="colourArrow" d="M2,1 L2,10 L10,6 L2,2" style="fill:blue" />
                            </marker>
                            </defs>
                            <path id="6_10" d="M428.666625 309.200892161325 L324.886370908699 103.71598906055" style="stroke:white; stroke-width: 3.25px; fill: none ;marker-end: url(#arrow10);" >
                            </path>
                            <defs>
                            <marker id="arrow" markerWidth="100" markerHeight="50" refx="15" refy="6" orient="auto">
                            <path id="colourArrow" d="M2,1 L2,10 L10,6 L2,2" style="fill:blue" />
                            </marker>
                            </defs>
                            <path id="9_10" d="M221.106116817399 309.200892161325 L324.886370908699 103.71598906055" style="stroke:pink; stroke-width: 3.25px; fill: none ;marker-end: url(#arrow11);" >
                            </path>
                            <defs>
                            <marker id="arrow" markerWidth="100" markerHeight="50" refx="15" refy="6" orient="auto">
                            <path id="colourArrow" d="M2,1 L2,10 L10,6 L2,2" style="fill:blue" />
                            </marker>
                            </defs>
                            <path id="9_13" d="M221.106116817399 309.200892161325 L117.325862726098 103.71598906055" style="stroke:brown; stroke-width: 3.25px; fill: none ;marker-end: url(#arrow12);" >
                            </path>
 </svg>
</div>
</div>
</div>
</div>

<ul class="legend">
    <li><span class="superawesome" ></span> 2</li>
    <li><span class="awesome"></span> 4</li>
    <li><span class="kindaawesome"></span> 7</li>
    <li><span class="notawesome"></span> 4</li>
    <li><span class="grey"></span> 20</li>
    <li><span class="brown"></span> 5</li>
    <li><span class="pink"></span> 1</li>
    <li><span class="white"></span> 8</li>
</ul>





<div id="hidden">&nbsp;</div>
<div id="hidden2">&nbsp;</div>
<div id="hidden3">&nbsp;</div>
<input name="next" style="display: none;" type="Submit" value="next" />
</div>
<p style ="width:150px; text-align: center; height:20px; background-color:#fff; border: 1px solid #999" id="output" hidden></p>
<script>
 var edgeArray=[[1,2,0,0,2],[1,5,0,0,2],[2,3,0,0,2],[2,6,0,0,2],[3,4,0,0,2],[3,7,0,0,2],[5,6,0,0,2],[5,9,0,0,2],[6,7,0,0,2],[6,10,0,0,2],[9,10,0,0,2],[9,13,0,0,2]];
                      ///////////// Count Down Timer Begin ////////////
                     timerHandle = null;

                      function countdown(minutes, seconds)
                      {
                      var endTime, hours, mins, msLeft, time;

                      function twoDigits(n)
                      {
                      return (n <= 9 ? "0" + n : n);
                      }
                      function updateTimer()
                      {
                      msLeft = endTime - (+new Date);
                      if (msLeft < 10000 * 6) {
                      document.getElementById("countdown2").style.color = "red";
                      }
                      if (msLeft < 1000) {
                      test.submit();
                      } else {
                      time = new Date(msLeft);
                      hours = time.getUTCHours();
                      mins = time.getUTCMinutes();
                      document.getElementById("countdown").innerHTML = (hours ? hours + ':' + twoDigits(mins) : mins) + ':' + twoDigits(time.getUTCSeconds());
                      document.getElementById("countdown2").innerHTML = (hours ? hours + ':' + twoDigits(mins) : mins) + ':' + twoDigits(time.getUTCSeconds());
                      timeStamp = twoDigits(mins) + ':' + twoDigits(time.getUTCSeconds());
                      timerHandle = setTimeout(updateTimer, time.getUTCMilliseconds() + 500);
                      }
                      }

                      endTime = (+new Date) + 1000 * (60 * minutes + seconds) + 500;
                      updateTimer();
                      }

                      countdown(01, 30);


                      var pageInput = document.getElementsByTagName("input");
                      for (i = 0; i < pageInput.length; i++) {
                      console.log(pageInput[i]);
                      pageInput[i].addEventListener('change', function ()
                      {
                      console.log('test')
                      document.getElementById("submitButton").disabled = false;
                      });
                      }



                      ///////////// Timer End ////////////

                      var isFirstNodeClicked=true;
                      var prevNodeId=null;
                      var nodeArray = [];
                      var timerArray = [];
                      var responseArray =[];
                      var node = [];
                      var clickedNodes=[];
                      function captureActionData(node, nodeArray, response, timeStamp){
                      var captureObject = {}; // Create empty JSON array
                      captureObject.node = node
                      captureObject.nodeArray = nodeArray;
                      captureObject.time = timeStamp;
                      captureObject.response = response;
                      responseArray.push(captureObject);
                      console.log(JSON.stringify(responseArray));
                      }



                      function nodeClick(nodeclicked) {
                      console.log('clickedNode = ' + nodeclicked.id + '; previous node = ' + prevNodeId);
                      //console.log(nodeclicked.id)
                      //console.log(edgeArray[0][1]);

                      var response ; // Recorded as right or wrong.

                      // Record first node ///////////
                      if (isFirstNodeClicked == true){
                      if(nodeclicked.id == edgeArray[1][0] && edgeArray[2][0]){
                      node = nodeclicked.id
                      response = "correct";
                      timerArray.push(timeStamp);
                      console.log(timerArray);
                      var nodeArray ;

                      captureActionData(node, 'NULL' ,response, timeStamp);

                      // create hidden layer (Dynamic)
                      var form = document.getElementById('hidden');
                      var div = document.createElement('div');
                      var inputElements1 = document.createElement('input');
                      inputElements1.setAttribute("type", "hidden");
                      inputElements1.setAttribute("name", "node");
                      //inputElements1.setAttribute("name", "nodeArray[" + edgeArray[i][0] + "][" + edgeArray[i][1] + "]");
                      inputElements1.setAttribute("value", node);
                      // inputElements1.innerHTML =  '<input type="hidden" name="nodeArray[' + edgeArray[i][0] + '][' + edgeArray[i][1] + ']" value="' + edgeArray[i] + '"/>'
                      div.appendChild(inputElements1);
                      form.appendChild(div);
                      // create hidden layer (Dynamic) [End] //

                      // create hidden layer (Dynamic) 'timestamp'
                      var inputElements2 = document.createElement('input');
                      inputElements2.setAttribute("type", "hidden");
                      inputElements2.setAttribute("name", "timeStamp");
                      //inputElements1.setAttribute("name", "nodeArray[" + edgeArray[i][0] + "][" + edgeArray[i][1] + "]");
                      inputElements2.setAttribute("value", timeStamp);
                      // inputElements1.innerHTML =  '<input type="hidden" name="nodeArray[' + edgeArray[i][0] + '][' + edgeArray[i][1] + ']" value="' + edgeArray[i] + '"/>'
                      div.appendChild(inputElements2);
                      form.appendChild(div);
                      // create hidden layer (Dynamic) [End] //

                      // create hidden layer (Dynamic) 'responses'
                      var inputElements3 = document.createElement('input');
                      inputElements3.setAttribute("type", "hidden");
                      inputElements3.setAttribute("name", "response");
                      //inputElements1.setAttribute("name", "nodeArray[" + edgeArray[i][0] + "][" + edgeArray[i][1] + "]");
                      inputElements3.setAttribute("value", response);
                      // inputElements1.innerHTML =  '<input type="hidden" name="nodeArray[' + edgeArray[i][0] + '][' + edgeArray[i][1] + ']" value="' + edgeArray[i] + '"/>'
                      div.appendChild(inputElements3);
                      form.appendChild(div);
                      // create hidden layer (Dynamic) [End] //

                      // create hidden layer (Dynamic)
                      var inputElements4 = document.createElement('input');
                      inputElements4.setAttribute("type", "hidden");
                      inputElements4.setAttribute("name", "nodePosition");
                      inputElements4.setAttribute("value", node);

                      div.appendChild(inputElements4);
                      form.appendChild(div);
                      // create hidden layer (Dynamic) [End] //


                      }else{
                      alert("Please start from the first node at the bottom");
                      node = nodeclicked.id
                      response = "notBottom";
                      timerArray.push(timeStamp);
                      console.log(timerArray);
                      var nodeArray ;

                      captureActionData(node, 'NULL' ,response, timeStamp);

                      // create hidden layer (Dynamic)
                      var form = document.getElementById('hidden');
                      var div = document.createElement('div');
                      var inputElements1 = document.createElement('input');
                      inputElements1.setAttribute("type", "hidden");
                      inputElements1.setAttribute("name", "node");
                      //inputElements1.setAttribute("name", "nodeArray[" + edgeArray[i][0] + "][" + edgeArray[i][1] + "]");
                      inputElements1.setAttribute("value", node);
                      // inputElements1.innerHTML =  '<input type="hidden" name="nodeArray[' + edgeArray[i][0] + '][' + edgeArray[i][1] + ']" value="' + edgeArray[i] + '"/>'
                      div.appendChild(inputElements1);
                      form.appendChild(div);
                      // create hidden layer (Dynamic) [End] //

                      // create hidden layer (Dynamic) 'timestamp'
                      var inputElements2 = document.createElement('input');
                      inputElements2.setAttribute("type", "hidden");
                      inputElements2.setAttribute("name", "timeStamp");
                      //inputElements1.setAttribute("name", "nodeArray[" + edgeArray[i][0] + "][" + edgeArray[i][1] + "]");
                      inputElements2.setAttribute("value", timeStamp);
                      // inputElements1.innerHTML =  '<input type="hidden" name="nodeArray[' + edgeArray[i][0] + '][' + edgeArray[i][1] + ']" value="' + edgeArray[i] + '"/>'
                      div.appendChild(inputElements2);
                      form.appendChild(div);
                      // create hidden layer (Dynamic) [End] //

                      // create hidden layer (Dynamic) 'responses'
                      var inputElements3 = document.createElement('input');
                      inputElements3.setAttribute("type", "hidden");
                      inputElements3.setAttribute("name", "response");
                      //inputElements1.setAttribute("name", "nodeArray[" + edgeArray[i][0] + "][" + edgeArray[i][1] + "]");
                      inputElements3.setAttribute("value", response);
                      // inputElements1.innerHTML =  '<input type="hidden" name="nodeArray[' + edgeArray[i][0] + '][' + edgeArray[i][1] + ']" value="' + edgeArray[i] + '"/>'
                      div.appendChild(inputElements3);
                      form.appendChild(div);
                      // create hidden layer (Dynamic) [End] //

                      // create hidden layer (Dynamic)
                      var inputElements4 = document.createElement('input');
                      inputElements4.setAttribute("type", "hidden");
                      inputElements4.setAttribute("name", "nodePosition");
                      inputElements4.setAttribute("value", node);

                      div.appendChild(inputElements4);
                      form.appendChild(div);
                      return;
                      }

                      }


                      /// Second node onwards ////////
                      if (isFirstNodeClicked == false) {
                      var pathExists = false;
                      for(var i=0; i<edgeArray.length; i++) {
                      //alert(edgeArray[i][0]);
                      //alert(edgeArray[i][1]);
                      if((edgeArray[i][0] == nodeclicked.id && edgeArray[i][1] == prevNodeId) || (edgeArray[i][0] == prevNodeId && edgeArray[i][1] == nodeclicked.id)) {
                      if ((edgeArray[i][2] == 0)) {
                      edgeArray[i][2] = 1;if((nodeclicked.id == 13) || (nodeclicked.id == 5) || (nodeclicked.id == 9) || (nodeclicked.id == 2) || (nodeclicked.id == 3) || (nodeclicked.id == 7) || (nodeclicked.id == 4) || (nodeclicked.id == 10)){
                      edgeArray[i][3] = 1;  // count total score
                      console.log(edgeArray[i]);
                      }

                      // JSON array
                      node = nodeclicked.id
                      response = "correct";
                      timerArray.push(timeStamp);
                      console.log(timerArray);
                      captureActionData(node, edgeArray[i], response, timeStamp);

                      // create hidden layer (Dynamic)
                      var form = document.getElementById('hidden');
                      var div = document.createElement('div');
                      var inputElements1 = document.createElement('input');
                      inputElements1.setAttribute("type", "hidden");
                      inputElements1.setAttribute("name", "node");
                      //inputElements1.setAttribute("name", "nodeArray[" + edgeArray[i][0] + "][" + edgeArray[i][1] + "]");
                      inputElements1.setAttribute("value", edgeArray[i]);
                      // inputElements1.innerHTML =  '<input type="hidden" name="nodeArray[' + edgeArray[i][0] + '][' + edgeArray[i][1] + ']" value="' + edgeArray[i] + '"/>'
                      div.appendChild(inputElements1);
                      form.appendChild(div);
                      // create hidden layer (Dynamic) [End] //

                      // create hidden layer (Dynamic) 'time stamp'
                      var inputElements2 = document.createElement('input');
                      inputElements2.setAttribute("type", "hidden");
                      inputElements2.setAttribute("name", "timeStamp");
                      //inputElements1.setAttribute("name", "nodeArray[" + edgeArray[i][0] + "][" + edgeArray[i][1] + "]");
                      inputElements2.setAttribute("value", timeStamp);
                      // inputElements1.innerHTML =  '<input type="hidden" name="nodeArray[' + edgeArray[i][0] + '][' + edgeArray[i][1] + ']" value="' + edgeArray[i] + '"/>'
                      div.appendChild(inputElements2);
                      form.appendChild(div);
                      // create hidden layer (Dynamic) [End] //

                      // create hidden layer (Dynamic) 'responses'
                      var inputElements3 = document.createElement('input');
                      inputElements3.setAttribute("type", "hidden");
                      inputElements3.setAttribute("name", "response");
                      //inputElements1.setAttribute("name", "nodeArray[" + edgeArray[i][0] + "][" + edgeArray[i][1] + "]");
                      inputElements3.setAttribute("value", response);
                      // inputElements1.innerHTML =  '<input type="hidden" name="nodeArray[' + edgeArray[i][0] + '][' + edgeArray[i][1] + ']" value="' + edgeArray[i] + '"/>'
                      div.appendChild(inputElements3);
                      form.appendChild(div);
                      // create hidden layer (Dynamic) [End] //

                      // create hidden layer (Dynamic)
                      var inputElements4 = document.createElement('input');
                      inputElements4.setAttribute("type", "hidden");
                      inputElements4.setAttribute("name", "nodePosition");
                      inputElements4.setAttribute("value", node);

                      div.appendChild(inputElements4);
                      form.appendChild(div);
                      // create hidden layer (Dynamic) [End] //

                      pathExists = true; //hooray path exists :P
                      // prevMyNode = document.getElementById(prevNodeId); // Put into new variable
                      //prevMyNode.style.backgroundColor = '#FFCF75';  // changes the color of the element of previous node ID

                      }

                      //unidirection
                      if(edgeArray[i][4] == 2 && Number(nodeclicked.id) < prevNodeId){
                      edgeArray[i][2] = 0;
                      node = nodeclicked.id
                      timerArray.push(timeStamp);
                      console.log(timerArray);
                      alert("Wrong direction");
                      response = "wrongDirection";
                      captureActionData(node, edgeArray[i], response, timeStamp);
                      // create hidden layer (Dynamic)
                      var form = document.getElementById('hidden');
                      var div = document.createElement('div');
                      var inputElements1 = document.createElement('input');
                      inputElements1.setAttribute("type", "hidden");
                      inputElements1.setAttribute("name", "node");
                      //inputElements1.setAttribute("name", "nodeArray[" + edgeArray[i][0] + "][" + edgeArray[i][1] + "]");
                      inputElements1.setAttribute("value", edgeArray[i]);
                      // inputElements1.innerHTML =  '<input type="hidden" name="nodeArray[' + edgeArray[i][0] + '][' + edgeArray[i][1] + ']" value="' + edgeArray[i] + '"/>'
                      div.appendChild(inputElements1);
                      form.appendChild(div);
                      // create hidden layer (Dynamic) [End] //

                      // create hidden layer (Dynamic) "time stamp"
                      var inputElements2 = document.createElement('input');
                      inputElements2.setAttribute("type", "hidden");
                      inputElements2.setAttribute("name", "timeStamp");
                      //inputElements1.setAttribute("name", "nodeArray[" + edgeArray[i][0] + "][" + edgeArray[i][1] + "]");
                      inputElements2.setAttribute("value", timeStamp);
                      // inputElements1.innerHTML =  '<input type="hidden" name="nodeArray[' + edgeArray[i][0] + '][' + edgeArray[i][1] + ']" value="' + edgeArray[i] + '"/>'
                      div.appendChild(inputElements2);
                      form.appendChild(div);
                      // create hidden layer (Dynamic) [End] //

                      // create hidden layer (Dynamic) 'responses'
                      var inputElements3 = document.createElement('input');
                      inputElements3.setAttribute("type", "hidden");
                      inputElements3.setAttribute("name", "response");
                      //inputElements1.setAttribute("name", "nodeArray[" + edgeArray[i][0] + "][" + edgeArray[i][1] + "]");
                      inputElements3.setAttribute("value", response);
                      // inputElements1.innerHTML =  '<input type="hidden" name="nodeArray[' + edgeArray[i][0] + '][' + edgeArray[i][1] + ']" value="' + edgeArray[i] + '"/>'
                      div.appendChild(inputElements3);
                      form.appendChild(div);
                      // create hidden layer (Dynamic) [End] //

                      // create hidden layer (Dynamic)
                      var inputElements4 = document.createElement('input');
                      inputElements4.setAttribute("type", "hidden");
                      inputElements4.setAttribute("name", "nodePosition");
                      inputElements4.setAttribute("value", node);

                      div.appendChild(inputElements4);
                      form.appendChild(div);
                      // create hidden layer (Dynamic) [End] //


                      //prevMyNode.style.backgroundColor = '#218868';
                      return false;
                      }

                      }

                      }



                      //check if the person tried to take a path that don't exists or repeated
                      if (pathExists == false) {
                      for(var i=0; i<edgeArray.length; i++) {
                      if((edgeArray[i][0] !== nodeclicked.id && edgeArray[i][1] !== prevNodeId) || (edgeArray[i][0] !== prevNodeId && edgeArray[i][1] !== nodeclicked.id)) {
                      if ((edgeArray[i][2] == 0)) { //checks that the user hasn't taken this path already
                      edgeArray[i][2] = 0; //makes it so that they can't take that path again
                      console.log(edgeArray[i]);
                      console.log(clickedNodes.length);


                      // Repeated nodes
                      if(nodeclicked.id == prevNodeId) {
                      timerArray.push(timeStamp);
                      console.log(timerArray);
                      alert("This is repeated");
                      response = "repeated";
                      captureActionData(clickedNodes[i], clickedNodes[i] ,response, timeStamp);

                      // create hidden layer (Dynamic)
                      var form = document.getElementById('hidden');
                      var div = document.createElement('div');
                      var inputElements1 = document.createElement('input');
                      inputElements1.setAttribute("type", "hidden");
                      inputElements1.setAttribute("name", "node");
                      //inputElements1.setAttribute("name", "nodeArray[" + edgeArray[i][0] + "][" + edgeArray[i][1] + "]");
                      inputElements1.setAttribute("value", nodeclicked.id);
                      // inputElements1.innerHTML =  '<input type="hidden" name="nodeArray[' + edgeArray[i][0] + '][' + edgeArray[i][1] + ']" value="' + edgeArray[i] + '"/>'
                      div.appendChild(inputElements1);
                      form.appendChild(div);
                      // create hidden layer (Dynamic) [End] //

                      // create hidden layer (Dynamic) "time stamp"
                      var inputElements2 = document.createElement('input');
                      inputElements2.setAttribute("type", "hidden");
                      inputElements2.setAttribute("name", "timeStamp");
                      //inputElements1.setAttribute("name", "nodeArray[" + edgeArray[i][0] + "][" + edgeArray[i][1] + "]");
                      inputElements2.setAttribute("value", timeStamp);
                      // inputElements1.innerHTML =  '<input type="hidden" name="nodeArray[' + edgeArray[i][0] + '][' + edgeArray[i][1] + ']" value="' + edgeArray[i] + '"/>'
                      div.appendChild(inputElements2);
                      form.appendChild(div);
                      // create hidden layer (Dynamic) [End] //

                      // create hidden layer (Dynamic) 'responses'
                      var inputElements3 = document.createElement('input');
                      inputElements3.setAttribute("type", "hidden");
                      inputElements3.setAttribute("name", "response");
                      //inputElements1.setAttribute("name", "nodeArray[" + edgeArray[i][0] + "][" + edgeArray[i][1] + "]");
                      inputElements3.setAttribute("value", response);
                      // inputElements1.innerHTML =  '<input type="hidden" name="nodeArray[' + edgeArray[i][0] + '][' + edgeArray[i][1] + ']" value="' + edgeArray[i] + '"/>'
                      div.appendChild(inputElements3);
                      form.appendChild(div);
                      // create hidden layer (Dynamic) [End] //

                      // create hidden layer (Dynamic)
                      var inputElements4 = document.createElement('input');
                      inputElements4.setAttribute("type", "hidden");
                      inputElements4.setAttribute("name", "nodePosition");
                      inputElements4.setAttribute("value", node);

                      div.appendChild(inputElements4);
                      form.appendChild(div);
                      // create hidden layer (Dynamic) [End] //
                      return false;

                      }

                      // JSON array
                      node = nodeclicked.id
                      timerArray.push(timeStamp);
                      console.log(timerArray);
                      alert('You cant go here!');
                      response = "incorrect";
                      captureActionData(node, edgeArray[i], response, timeStamp);

                      // create hidden layer (Dynamic)
                      var form = document.getElementById('hidden');
                      var div = document.createElement('div');
                      var inputElements1 = document.createElement('input');
                      inputElements1.setAttribute("type", "hidden");
                      inputElements1.setAttribute("name", "node");
                      //inputElements1.setAttribute("name","nodeArray[" + edgeArray[i][0] + "][" + edgeArray[i][1] + "]");
                      inputElements1.setAttribute("value", edgeArray[i]);
                      // inputElements1.innerHTML =  '<input type="hidden" name="nodeArray[' + edgeArray[i][0] + '][' + edgeArray[i][1] + ']" value="' + edgeArray[i] + '"/>'
                      div.appendChild(inputElements1);
                      form.appendChild(div);
                      // create hidden layer (Dynamic) [End] //

                      // create hidden layer (Dynamic) "time stamp"
                      var inputElements2 = document.createElement('input');
                      inputElements2.setAttribute("type", "hidden");
                      inputElements2.setAttribute("name", "timeStamp");
                      //inputElements1.setAttribute("name", "nodeArray[" + edgeArray[i][0] + "][" + edgeArray[i][1] + "]");
                      inputElements2.setAttribute("value", timeStamp);
                      // inputElements1.innerHTML =  '<input type="hidden" name="nodeArray[' + edgeArray[i][0] + '][' + edgeArray[i][1] + ']" value="' + edgeArray[i] + '"/>'
                      div.appendChild(inputElements2);
                      form.appendChild(div);
                      // create hidden layer (Dynamic) [End] //

                      // create hidden layer (Dynamic) 'responses'
                      var inputElements3 = document.createElement('input');
                      inputElements3.setAttribute("type", "hidden");
                      inputElements3.setAttribute("name", "response");
                      //inputElements1.setAttribute("name", "nodeArray[" + edgeArray[i][0] + "][" + edgeArray[i][1] + "]");
                      inputElements3.setAttribute("value", response);
                      // inputElements1.innerHTML =  '<input type="hidden" name="nodeArray[' + edgeArray[i][0] + '][' + edgeArray[i][1] + ']" value="' + edgeArray[i] + '"/>'
                      div.appendChild(inputElements3);
                      form.appendChild(div);
                      // create hidden layer (Dynamic) [End] //

                      // create hidden layer (Dynamic)
                      var inputElements4 = document.createElement('input');
                      inputElements4.setAttribute("type", "hidden");
                      inputElements4.setAttribute("name", "nodePosition");
                      inputElements4.setAttribute("value", node);

                      div.appendChild(inputElements4);
                      form.appendChild(div);
                      // create hidden layer (Dynamic) [End] //

                      return false;




                      }
                      }
                      }
                      }

                      }

                      // we successfully clicked on something, so change colour of stuff (line and node)
                      if (isFirstNodeClicked == true){
                      nodeclicked.style.backgroundColor = 'red';
                      }

                      // Create getChildren(gets all the nodes including the node you click)
                      // changes the colour of everything except the node you click on
                      function getChildren(n, skipMe){
                      var r = [];
                      for ( ; n; n = n.nextSibling )
                      if ( n.nodeType == 1 && n != skipMe)
                      r.push( n );
                      return r;
                      };
                      // Create getsiblings(gets all the nodes except the node you click)
                      function getSiblings(n) {
                      return getChildren(n.parentNode.firstChild, n);
                      }


                      if (isFirstNodeClicked == false) { // the line doesnt change colour the first time

                      if (Number(nodeclicked.id) > Number(prevNodeId)) {
                      var elementname = prevNodeId+'_'+nodeclicked.id;
                      } else {
                      var elementname = nodeclicked.id+'_'+prevNodeId;
                      }

                      console.log('element_name = ' + elementname + 'clicked node = ' + nodeclicked.id + '; previous node = ' + prevNodeId);

                      // this breaks if there is no if-statement on line 302. Because it doesn't continue onwards and reset nodeclicked into prevNode.
                      // So you need the if statement. Once that is true, then it continues on with the code.
                      myelement = document.getElementById(elementname);
                      myelement.style.stroke = '#FF0000';


                      }

                      // set things up for next time
                      prevNodeId = nodeclicked.id;
                      isFirstNodeClicked=false;

                      if (isFirstNodeClicked == false){
                      nodeclicked.style.borderColor = 'red';
                      }


                      // suming up the score of the person based on the black dotes crossed
                      var sum = 0;
                      for(i =0; i < edgeArray.length; i++){
                      //console.log(edgeArray[i][3]);
                      sum  += edgeArray[i][3];
                      }
                      console.log(sum); // 6


                      // check stopping rules
                      var completedGame = true;
                      if(sum == 3){ if((nodeclicked.id == edgeArray[4][1]) || (nodeclicked.id == edgeArray[5][1]) || (nodeclicked.id == edgeArray[8][1]) || (nodeclicked.id == edgeArray[9][1]) || (nodeclicked.id == edgeArray[10][1]) || (nodeclicked.id == edgeArray[11][1])){
    console.log(edgeArray[4][1]);
    alert('Congratulations! You solved the puzzle!');

    var form = document.getElementById('hidden2');
    var div = document.createElement('div');
    var inputElements4 = document.createElement('input');
    inputElements4.setAttribute("type", "hidden");
    inputElements4.setAttribute("name", "completedGame");
    inputElements4.setAttribute("value", 1);
    div.appendChild(inputElements4);
    form.appendChild(div);

    var form = document.getElementById('hidden3');
    var div = document.createElement('div');
    var inputElements5 = document.createElement('input');
    inputElements5.setAttribute("type", "hidden");
    inputElements5.setAttribute("name", "totalGoldScore");
    inputElements5.setAttribute("value", sum);
    div.appendChild(inputElements5);
    form.appendChild(div);


    clearTimeout(timerHandle);
    testRunner.submitView('next'); // concerto
    return true; // stop the script.
}

}else{if((nodeclicked.id == edgeArray[4][1]) || (nodeclicked.id == edgeArray[5][1]) || (nodeclicked.id == edgeArray[8][1]) || (nodeclicked.id == edgeArray[9][1]) || (nodeclicked.id == edgeArray[10][1]) || (nodeclicked.id == edgeArray[11][1])){
console.log(edgeArray[4][1]);
alert("Sorry, that was not the maximum score");

var form = document.getElementById('hidden2');
var div = document.createElement('div');
var inputElements4 = document.createElement('input');
inputElements4.setAttribute("type", "hidden");
inputElements4.setAttribute("name", "completedGame");
inputElements4.setAttribute("value", 0);
  div.appendChild(inputElements4);
  form.appendChild(div);

  var form = document.getElementById('hidden3');
  var div = document.createElement('div');
  var inputElements5 = document.createElement('input');
  inputElements5.setAttribute("type", "hidden");
  inputElements5.setAttribute("name", "totalGoldScore");
  inputElements5.setAttribute("value", sum);
  div.appendChild(inputElements5);
  form.appendChild(div);
  clearTimeout(timerHandle);
  testRunner.submitView('next'); // concerto
  return true; // stop the script.

                      }
                    }

  clickedNodes.push(nodeclicked.id); // array for repeated logic



                    }


</script>


</body>

</html>

{% endblock %}
